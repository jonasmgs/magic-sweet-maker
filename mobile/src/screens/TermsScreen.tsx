/**
 * Tela de Termos de Uso
 *
 * Exibe os termos de uso da assinatura
 */

import React from 'react';
import {
  View,
  Text,
  StyleSheet,
  ScrollView,
  TouchableOpacity,
} from 'react-native';
import { LinearGradient } from 'expo-linear-gradient';
import { SafeAreaView } from 'react-native-safe-area-context';
import { useNavigation } from '@react-navigation/native';
import { useLanguage } from '../context/LanguageContext';
import { getThemeColors, fonts, spacing, borderRadius } from '../utils/theme';

export function TermsScreen() {
  const navigation = useNavigation();
  const { theme, t, language } = useLanguage();
  const themeColors = getThemeColors(theme);
  const isMasculine = theme === 'masculine';

  const gradientColors = isMasculine
    ? ['#0F0F1A', '#1A1A2E', '#16213E'] as const
    : ['#87CEEB', '#E0F6FF', '#FFF5E1'] as const;

  // Termos em m√∫ltiplos idiomas
  const terms = {
    en: {
      title: 'Terms of Use',
      lastUpdated: 'Last updated: January 2026',
      sections: [
        {
          title: '1. Subscription',
          content: `The subscription is monthly and automatically renewed at the end of each billing cycle. Payment is processed through the App Store (iOS) or Google Play (Android).

You can choose between two plans:
‚Ä¢ CandyCandy: $9.99/month - Up to 150 recipes per month
‚Ä¢ CandyCandy Basic: $4.99/month - Up to 60 recipes per month

Prices may vary by region and local currency. The displayed price is always in your local currency.`,
        },
        {
          title: '2. Monthly Limits',
          content: `Each subscription plan has a monthly limit of recipe generations:
‚Ä¢ Limits reset at the beginning of each billing cycle
‚Ä¢ Unused limits do NOT carry over to the next month
‚Ä¢ When the limit is reached, you must wait for the next cycle or upgrade your plan`,
        },
        {
          title: '3. Cancellation',
          content: `You can cancel your subscription at any time through your device settings:
‚Ä¢ iOS: Settings > Apple ID > Subscriptions
‚Ä¢ Android: Google Play > Subscriptions

After cancellation:
‚Ä¢ Premium access remains until the end of the paid period
‚Ä¢ No refund for partial months
‚Ä¢ You can resubscribe at any time`,
        },
        {
          title: '4. Refund',
          content: `Refunds are processed according to Apple App Store or Google Play policies. Contact the respective store for refund requests.`,
        },
        {
          title: '5. Content',
          content: `Recipes are generated by artificial intelligence and are for entertainment and educational purposes. Always have adult supervision when preparing recipes with children.`,
        },
        {
          title: '6. Changes',
          content: `We reserve the right to modify these terms. Changes will be notified within the app. Continued use of the service after modifications implies acceptance of the new terms.`,
        },
      ],
    },
    pt: {
      title: 'Termos de Uso',
      lastUpdated: '√öltima atualiza√ß√£o: Janeiro 2026',
      sections: [
        {
          title: '1. Assinatura',
          content: `A assinatura √© mensal e renovada automaticamente ao final de cada ciclo de cobran√ßa. O pagamento √© processado pela App Store (iOS) ou Google Play (Android).

Voc√™ pode escolher entre dois planos:
‚Ä¢ CandyCandy: $9,99/m√™s - At√© 150 receitas por m√™s
‚Ä¢ CandyCandy Basic: $4,99/m√™s - At√© 60 receitas por m√™s

Os pre√ßos podem variar conforme a regi√£o e moeda local. O pre√ßo exibido √© sempre na sua moeda local.`,
        },
        {
          title: '2. Limites Mensais',
          content: `Cada plano de assinatura possui um limite mensal de gera√ß√µes de receitas:
‚Ä¢ Os limites s√£o resetados no in√≠cio de cada ciclo de cobran√ßa
‚Ä¢ Limites n√£o utilizados N√ÉO acumulam para o m√™s seguinte
‚Ä¢ Ao atingir o limite, voc√™ deve aguardar o pr√≥ximo ciclo ou fazer upgrade do plano`,
        },
        {
          title: '3. Cancelamento',
          content: `O cancelamento pode ser feito a qualquer momento nas configura√ß√µes do seu dispositivo:
‚Ä¢ iOS: Ajustes > Apple ID > Assinaturas
‚Ä¢ Android: Google Play > Assinaturas

Ap√≥s o cancelamento:
‚Ä¢ O acesso premium permanece at√© o final do per√≠odo pago
‚Ä¢ N√£o h√° reembolso por meses parciais
‚Ä¢ Voc√™ pode reassinar a qualquer momento`,
        },
        {
          title: '4. Reembolso',
          content: `Reembolsos s√£o processados de acordo com as pol√≠ticas da Apple App Store ou Google Play. Entre em contato com a respectiva loja para solicitar reembolso.`,
        },
        {
          title: '5. Conte√∫do',
          content: `As receitas s√£o geradas por intelig√™ncia artificial e s√£o para fins de entretenimento e educacionais. Sempre tenha supervis√£o de um adulto ao preparar receitas com crian√ßas.`,
        },
        {
          title: '6. Altera√ß√µes',
          content: `Reservamos o direito de modificar estes termos. Altera√ß√µes ser√£o comunicadas dentro do aplicativo. O uso continuado do servi√ßo ap√≥s modifica√ß√µes implica na aceita√ß√£o dos novos termos.`,
        },
      ],
    },
    es: {
      title: 'T√©rminos de Uso',
      lastUpdated: '√öltima actualizaci√≥n: Enero 2026',
      sections: [
        {
          title: '1. Suscripci√≥n',
          content: `La suscripci√≥n es mensual y se renueva autom√°ticamente al final de cada ciclo de facturaci√≥n. El pago se procesa a trav√©s de la App Store (iOS) o Google Play (Android).

Puedes elegir entre dos planes:
‚Ä¢ CandyCandy: $9.99/mes - Hasta 150 recetas por mes
‚Ä¢ CandyCandy Basic: $4.99/mes - Hasta 60 recetas por mes

Los precios pueden variar seg√∫n la regi√≥n y la moneda local.`,
        },
        {
          title: '2. L√≠mites Mensuales',
          content: `Cada plan tiene un l√≠mite mensual de generaciones:
‚Ä¢ Los l√≠mites se reinician al inicio de cada ciclo
‚Ä¢ Los l√≠mites no utilizados NO se acumulan
‚Ä¢ Al alcanzar el l√≠mite, debes esperar el pr√≥ximo ciclo`,
        },
        {
          title: '3. Cancelaci√≥n',
          content: `Puedes cancelar en cualquier momento en la configuraci√≥n de tu dispositivo.`,
        },
        {
          title: '4. Reembolso',
          content: `Los reembolsos se procesan seg√∫n las pol√≠ticas de Apple o Google Play.`,
        },
        {
          title: '5. Contenido',
          content: `Las recetas son generadas por IA y son para entretenimiento. Siempre con supervisi√≥n de adultos.`,
        },
        {
          title: '6. Cambios',
          content: `Nos reservamos el derecho de modificar estos t√©rminos.`,
        },
      ],
    },
  };

  // Fallback para ingl√™s se o idioma n√£o estiver dispon√≠vel
  const currentTerms = terms[language as keyof typeof terms] || terms.en;

  return (
    <LinearGradient colors={gradientColors} style={styles.gradient}>
      <SafeAreaView style={styles.container}>
        {/* Header */}
        <View style={styles.header}>
          <TouchableOpacity
            onPress={() => navigation.goBack()}
            style={[styles.backButton, { backgroundColor: themeColors.card }]}
          >
            <Text style={[styles.backText, { color: themeColors.text }]}>‚Üê</Text>
          </TouchableOpacity>
          <Text style={[styles.title, { color: themeColors.text }]}>
            üìÑ {currentTerms.title}
          </Text>
          <View style={styles.placeholder} />
        </View>

        <ScrollView
          style={styles.scrollView}
          contentContainerStyle={styles.content}
          showsVerticalScrollIndicator={false}
        >
          {/* Data de atualiza√ß√£o */}
          <Text style={[styles.lastUpdated, { color: themeColors.textSecondary }]}>
            {currentTerms.lastUpdated}
          </Text>

          {/* Se√ß√µes dos termos */}
          {currentTerms.sections.map((section, index) => (
            <View
              key={index}
              style={[
                styles.section,
                { backgroundColor: themeColors.card },
              ]}
            >
              <Text style={[styles.sectionTitle, { color: themeColors.primary }]}>
                {section.title}
              </Text>
              <Text style={[styles.sectionContent, { color: themeColors.text }]}>
                {section.content}
              </Text>
            </View>
          ))}

          {/* Contato */}
          <View style={[styles.contactBox, { backgroundColor: themeColors.card }]}>
            <Text style={[styles.contactTitle, { color: themeColors.text }]}>
              üìß {language === 'pt' ? 'Contato' : 'Contact'}
            </Text>
            <Text style={[styles.contactText, { color: themeColors.textSecondary }]}>
              support@magicsweetmaker.com
            </Text>
          </View>

          {/* Decora√ß√£o */}
          <View style={styles.decoration}>
            {(isMasculine ? ['ü¶∏', '‚ö°', 'üí™'] : ['üßÅ', 'üç∞', 'üç≠']).map((e, i) => (
              <Text key={i} style={styles.decorEmoji}>{e}</Text>
            ))}
          </View>
        </ScrollView>
      </SafeAreaView>
    </LinearGradient>
  );
}

const styles = StyleSheet.create({
  gradient: {
    flex: 1,
  },
  container: {
    flex: 1,
  },
  header: {
    flexDirection: 'row',
    alignItems: 'center',
    justifyContent: 'space-between',
    paddingHorizontal: spacing.lg,
    paddingVertical: spacing.md,
  },
  backButton: {
    width: 44,
    height: 44,
    borderRadius: 22,
    alignItems: 'center',
    justifyContent: 'center',
  },
  backText: {
    fontSize: 24,
    fontWeight: 'bold',
  },
  title: {
    fontSize: fonts.sizes.xl,
    fontWeight: 'bold',
  },
  placeholder: {
    width: 44,
  },
  scrollView: {
    flex: 1,
  },
  content: {
    padding: spacing.lg,
  },
  lastUpdated: {
    fontSize: fonts.sizes.sm,
    marginBottom: spacing.lg,
    textAlign: 'center',
  },
  section: {
    borderRadius: borderRadius.lg,
    padding: spacing.lg,
    marginBottom: spacing.md,
  },
  sectionTitle: {
    fontSize: fonts.sizes.md,
    fontWeight: 'bold',
    marginBottom: spacing.sm,
  },
  sectionContent: {
    fontSize: fonts.sizes.sm,
    lineHeight: 22,
  },
  contactBox: {
    borderRadius: borderRadius.lg,
    padding: spacing.lg,
    marginTop: spacing.md,
    alignItems: 'center',
  },
  contactTitle: {
    fontSize: fonts.sizes.md,
    fontWeight: 'bold',
    marginBottom: spacing.xs,
  },
  contactText: {
    fontSize: fonts.sizes.sm,
  },
  decoration: {
    flexDirection: 'row',
    justifyContent: 'center',
    gap: spacing.md,
    marginTop: spacing.xl,
    marginBottom: spacing.xxl,
  },
  decorEmoji: {
    fontSize: 32,
    opacity: 0.6,
  },
});
